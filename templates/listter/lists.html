<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Listter Lists</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
</head>
<body>
  Lists
  {{ user.profile.screen_name }}
  {% if debug %}
    <br>{{ user.profile.oauth_token }}
    <br>{{ user.profile.oauth_secret }}
  {% endif %}
  <br>{{ lists | length }}
  {% for list in lists %}
  <br>{{ list.name }}
  {% endfor %}

  <h4>{{ friends.ids | length }} Friends</h4>

  {% for f in rich_friends %}
  <br>{{ f.name }} @{{ f.screen_name }}
  <br>{{ f.location }}
  <br>{{ f.description }}
  <br>{{ f.url }}
  <br><img src="{{ f.profile_image_url_https }}">
  <br>{{ f.status.text }}
  {% endfor %}

  <h4>{{ lists_members.users | length }} List members</h4>
  {% for user in lists_members.users %}
  <br>{{ user.id }}
  {% endfor %}



  {# df #}

  {% verbatim %}
  <div id="app-7">
    <button v-on:click="postTable">POST</button>
    <table>
      <tbody>
        <tr v-for="(member_value, member_id) in membersLists">
          <td >{{ member_id }}</td>
          <td v-for="(v, list_id) in member_value">
            <button v-on:click="postMember(member_id, list_id, v)">{{ v }}</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  {% endverbatim %}

<script type="text/javascript">
var csrftoken = Cookies.get('csrftoken');
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
      xhr.setRequestHeader("X-CSRFToken", csrftoken);
    }
});
var app7 = new Vue({
  el: '#app-7',
  data: {
    membersLists: {{ df | safe}}
  },
  methods: {
    toggleMember: function (id_name, list_name, current_value) {
      this.membersLists[id_name][list_name] = !current_value
      console.log('a');
      console.log(id_name);
      console.log(list_name);
      console.log(current_value);
    },
    postTable: function () {
      $.post(
        '/listter/post_lists/',
        {table: this.membersLists}
      ).then( function(response){
        console.log('success');
        console.log(response);
      }, function(response){
        console.log('falure');
      })
    },
    postMember: function(user_id, list_id, v) {
      this.membersLists[user_id][list_id] = !v
      $.post(
        '/listter/post_member/',
        {
          user_id: user_id,
          list_id: list_id,
          v: v,
        }
      ).then( function(response){
        console.log('success');
        console.log(response);
      }, function(response){
        console.log('falure');
      })
    }
  }
})
</script>



</body>
</html>
